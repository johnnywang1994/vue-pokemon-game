var K=Object.defineProperty;var R=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var P=(n,t,e)=>t in n?K(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,w=(n,t)=>{for(var e in t||(t={}))V.call(t,e)&&P(n,e,t[e]);if(R)for(var e of R(t))O.call(t,e)&&P(n,e,t[e]);return n};import{d as C,r as S,o as j,a as b,c as k,F as U,b as l,e as D,f as q,g as G,h as p,i as H,j as Z}from"./vendor.0903bfb1.js";function X0(){import("data:text/javascript,")}const J=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}};J();function N(n){const t=n.length,e=[];for(let s=0;s<t;s++){const i=n[s];Array.isArray(i)?e.push(...N(i)):e.push(i)}return e}class E{constructor(){this.id=Math.random().toString().slice(2),this.label="Composite",this.cidMap={},this.allBodies=[],this.allComposites=[],this.parent=null}get bodies(){return N([...this.allBodies,...this.allComposites])}add(t){const{allComposites:e,allBodies:s}=this,i=o=>{o.parent=this,o.label==="Composite"?e.push(o):s.push(o),o.cid&&(this.cidMap[o.cid]=o)};Array.isArray(t)?t.forEach(o=>i(o)):t&&i(t)}remove(t){let e,s;return t.label==="Composite"?e=this.allComposites:e=this.allBodies,e&&(s=e.indexOf(t),s)?(e.splice(s,1),!0):!1}get(t){return this.cidMap[t]||!1}clear(){this.allBodies=[],this.allComposites=[]}draw(t){const{bodies:e}=this,s=e.length;for(let i=0;i<s;i++)e[i].draw(t)}}class Q{constructor(t){this.options=w({gravity:{x:0,y:3}},t),this.renderer=null,this.world=new E,this.timing={lastDelta:0,lastElapsed:0}}clear(){this.timing.lastDelta=0,this.timing.lastElapsed=0}}async function W(n,t){return new Promise(e=>{const s=new Image;s.onload=()=>e({id:n,image:s}),s.src=t})}class X{constructor(){this.pending=[],this.assets={},this.length=0,this.counter=0,this.percent=0}add(t,e){if(this.assets[t])return console.error(`Assets ID: ${t} was used, please use an unique id.`),!1;this.length+=1;const s=W(t,e).then(({id:i,image:o})=>{this.counter+=1,this.percent=Math.floor(this.counter/this.length*100),this.assets[i]=o});return this.pending.push(s),!0}async load(){await Promise.all(this.pending),this.pending=[],console.log("load assets successful",this.assets)}}class Y{constructor(t){this.options=w({fps:60,checkFps:!1},t),this.fps=this.options.fps,this.fpsInterval=1e3/this.fps,this.frameId=null,this.fpsLast=null,this.active=!1}stop(){window.cancelAnimationFrame(this.frameId),this.fpsLast=null,this.active=!1}run(){this.step()}step(){if(this.frameId=window.requestAnimationFrame(this.step.bind(this)),!this.fpsLast){this.active=!0,this.fpsLast=performance.now();return}const t=performance.now(),e=t-this.fpsLast,{fpsInterval:s}=this;e>s&&(this.options.checkFps&&console.log(1e3/e),this.fpsLast=t-e%s,this.draw(e))}draw(){}}class t0 extends Y{constructor(t){super(t);this.engine=null,this.canvas=t.canvas,this.ctx=this.canvas.getContext("2d"),this.pixelRatio={x:1,y:1},this.resizeCallback=null,this.init()}init(){const{canvas:t,options:e}=this;t.width=e.width,t.height=e.height,this.resizeCallback=()=>{const{width:s,height:i}=t.getBoundingClientRect();this.pixelRatio={x:s/t.width,y:i/t.height}},this.resizeCallback(),document.addEventListener("resize",this.resizeCallback)}stop(){super.stop(),document.removeEventListener("resize",this.resizeCallback)}run(t){t.renderer=this,this.engine=t,super.run()}draw(t){const{ctx:e,engine:s,options:i,fpsInterval:o}=this;s.timing.lastDelta=o,s.timing.lastElapsed=t,e.clearRect(0,0,i.width,i.height),e.save(),e.fillStyle=i.background,e.fillRect(0,0,i.width,i.height),e.restore(),s.world.draw(e)}}const B={detect(n,t,e=1){const{position:s,size:i}=n,{position:o,size:a}=t;return s.x<=o.x+a.width*e&&s.x+i.width*e>=o.x&&s.y<=o.y+a.height*e&&s.y+i.height*e>=o.y},detectAt(n,t){const{x:e,y:s}=n,{position:i,size:o}=t;return e>=i.x&&e<=i.x+o.width&&s>=i.y&&s<=i.y+o.height},detectArea(n,t,e=1){const{position:s,size:i}=n,{position:o,size:a}=t,r=Math.min(s.x+i.width*e,o.x+a.width*e)-Math.max(s.x,o.x),h=Math.min(s.y+i.height*e,o.y+a.height*e)-Math.max(s.y,o.y);return r*h}},e0=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,342,342,342,342,342,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,342,342,0,0,0,0,0,0,0,342,0,0,342,342,0,0,342,342,342,342,342,342,342,342,342,342,342,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,342,342,0,0,342,0,0,342,342,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,342,0,342,0,342,0,0,0,0,0,0,0,0,0,0,0,0,342,342,342,342,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,342,342,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,342,342,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,342,342,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,342,342,342,342,342,342,342,342,342,0,0,0,342,342,342,342,342,0,342,342,342,342,342,342,342,342,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,342,342,342,342,342,342,342,342,342,0,342,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,342,342,342,342,342,342,342,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,342,342,342,342,342,342,342,342,0,342,342,342,342,342,342,342,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,342,0,0,0,0,0,0,342,0,342,0,0,0,0,0,342,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,342,0,0,0,0,0,0,342,0,342,0,0,0,0,0,342,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,342,0,0,0,0,0,0,342,0,342,0,0,0,0,0,342,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,342,342,342,342,0,0,342,342,0,342,342,342,0,342,342,342,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,342,342,342,342,342,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,342,342,342,342,342,342,0,0,342,0,0,342,0,0,0,0,0,0,342,342,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,342,0,342,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,342,342,342,0,0,0,0,342,0,342,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,342,342,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,342,0,342,0,0,342,342,342,342,342,0,0,0,0,0,0,0,0,0,0,0,342,0,342,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,342,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,342,342,0,0,0,0,342,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,342,342,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,342,342,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,342,342,342,342,342,342,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,342,342,342,342,342,342,342,342,342,342,342,342,342,342,342,342,342,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,342,342,0,0,342,342,342,0,342,0,342,342,342,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,342,342,0,0,342,342,0,0,0,0,342,342,0,0,0,342,0,342,342,0,0,0,0,0,0,0,0,0,0,0,0,0,342,342,342,342,0,342,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,342,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,342,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,342,342,0,0,0,0,342,0,0,0,0,342,342,342,342,342,342,342,342,342,342,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,342,342,342,342,342,342,342,342,342,342,342,342,342,342,342,342,342,0,0,0,0,0,0,0,0,0,0,0,0],s0=40,i0=13,o0="Collision",n0=.5,a0="tilelayer",r0=!0,l0=40,h0=0,c0=0;var d0={data:e0,height:s0,id:i0,name:o0,opacity:n0,type:a0,visible:r0,width:l0,x:h0,y:c0};const p0=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,343,343,343,343,0,343,343,343,343,0,343,343,343,343,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,343,343,343,343,0,343,343,343,343,0,343,343,343,343,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,343,343,343,343,0,343,343,343,343,0,343,343,343,343,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],u0=40,f0=18,m0="BattleZone",g0=.5,y0="tilelayer",w0=!0,b0=40,v0=0,x0=0;var _0={data:p0,height:u0,id:f0,name:m0,opacity:g0,type:y0,visible:w0,width:b0,x:v0,y:x0};const g={x:-1218,y:-800},k0=T(d0.data,342,40),z0=T(_0.data,343,40);function T(n,t,e){const s=[];for(let i=0;i<n.length;i+=e)for(let o=i;o<i+e;o++)if(n[o]===t){const a={position:{x:(o-i)*64,y:Math.floor(i/e)*64},size:{width:16,height:16}};a.position.x+=g.x,a.position.y+=g.y,s.push(a)}return s}function B0(){const n=new E,t=[];return k0.forEach(({position:e})=>{t.push(new L0(e.x,e.y))}),n.add(t),n.cid="collisions",n}function C0(){const n=new E,t=[];return z0.forEach(({position:e})=>{t.push(new M0(e.x,e.y))}),n.add(t),n.cid="battlezones",n}class E0{constructor(t,e,s={}){this.options=w({render:{}},s),this.size=null,this.render=w({fillStyle:"yellow"},s.render),this.position={x:t,y:e},this.velocity={x:0,y:0}}translate(t){this.position.x+=t.x,this.position.y+=t.y}setPosition(t){this.position.x=t.x,this.position.y=t.y}setVelocity(t){this.velocity.x=t.x,this.velocity.y=t.y}draw(t){}}class d extends E0{constructor(t,e,s,i){super(t,e);this.size={width:s,height:i},this.opacity=1}draw(t){const{position:e,size:s,render:i}=this;t.fillStyle=i.fillStyle,t.fillRect(e.x,e.y,s.width*4,s.height*4)}attack({attack:t,target:e}){const s=gsap.timeline();let i=20,o="#enemy-life";this.isEnemy&&(i=-i,o="#us-life"),s.to(this.position,{x:this.position.x-i,duration:.3}).to(this.position,{x:this.position.x+i*2,y:this.position.y-i,duration:.15,onComplete(){gsap.to(e.position,{x:e.position.x+i,repeat:5,yoyo:!0,duration:.08}),gsap.to(e,{opacity:0,repeat:5,yoyo:!0,duration:.08}),gsap.to(o,{width:e.health-t.damage+"%",onComplete(){if(e.health-=t.damage,e.health<=0&&e.isEnemy){const{world:a}=window.gameEngine;a.get("player").status="static",a.get("battlebg").open=!1,a.remove(window.transport.battleEnemy),window.transport.stopBattle()}}})}}).to(this.position,{x:this.position.x,y:this.position.y})}}class L0 extends d{constructor(t,e){super(t,e-16,16,16);this.render.fillStyle="transparent"}}class M0 extends d{constructor(t,e){super(t,e,16,16);this.render.fillStyle="transparent"}}class $0 extends d{constructor(){super(g.x,g.y,0,0);this.cid="map",this.image=window.gameLoader.assets.map}draw(t){const{position:e,image:s}=this;t.drawImage(s,e.x,e.y)}}class A0 extends d{constructor(){super(g.x,g.y,0,0);this.cid="foreground",this.image=window.gameLoader.assets.foreground}draw(t){const{position:e,image:s}=this;t.drawImage(s,e.x,e.y)}}class I0 extends d{constructor(){const{canvas:t}=window.gameRender;super(0,0,t.width,t.height);this.cid="battlebg",this.image=window.gameLoader.assets.battlebg,this.open=!1}draw(t){if(this.open){const{position:e,image:s,size:i}=this;t.drawImage(s,e.x,e.y,i.width,i.height)}}}class R0 extends d{constructor(){const{canvas:t}=window.gameRender;super(t.width/2,t.height/2,16,16);this.cid="player",this.status="static",this.direction="down",this.frame=0,this.frameRow={down:0,up:1,left:2,right:3},this.frameMax=4,this.elapse=0,this.movement={down:[0,-4],up:[0,4],left:[4,0],right:[-4,0]},this.engine=window.gameEngine,this.image=window.gameLoader.assets.player,this.onKeyDownListener=this.onKeyDown.bind(this),this.onKeyUpListener=this.onKeyUp.bind(this)}init(){document.addEventListener("keydown",this.onKeyDownListener),document.addEventListener("keyup",this.onKeyUpListener)}onKeyDown(t){if(this.status!=="battle")switch(["w","a","s","d"].includes(t.key)&&(this.status="move"),t.key){case"w":this.direction="up";break;case"s":this.direction="down";break;case"a":this.direction="left";break;case"d":this.direction="right";break}}onKeyUp(){this.status!=="battle"&&(this.status="static")}static(t){const{position:e,size:s,image:i,direction:o,frame:a,frameRow:r}=this;t.drawImage(i,a*16,r[o]*16,s.width,s.height,e.x,e.y,s.width*4,s.height*4),this.elapse++,this.elapse%10===0&&(a<1?this.frame++:this.frame=0)}battle(t){const{position:e,size:s,image:i,direction:o,frame:a,frameRow:r}=this;t.drawImage(i,a*16,r[o]*16,s.width,s.height,e.x,e.y,s.width*4,s.height*4)}move(t){const{translateList:e}=window,s=this.engine.world.get("collisions"),i=this.engine.world.get("battlezones"),{position:o,size:a,image:r,direction:h,frame:x,frameRow:u,frameMax:f,movement:z}=this,_=z[h];t.drawImage(r,x*16,u[h]*16,a.width,a.height,o.x,o.y,a.width*4,a.height*4),this.elapse++,this.elapse%10===0&&(x<f-1?this.frame++:this.frame=2);const L=s.bodies;let M=!0;for(let m=0;m<L.length;m++){const c=L[m];if(B.detect(this,{position:{x:c.position.x+_[0],y:c.position.y+_[1]},size:c.size},3.5)){M=!1;break}}if(M){e.forEach(c=>{c.translate({x:_[0],y:_[1]})});const m=i.bodies;for(let c=0;c<m.length;c++){const $=m[c],{size:A}=this;if(B.detect(this,$,4)&&B.detectArea(this,$,4)>A.width*A.height*16/2&&Math.random()<.05){const F=this.engine.world.get("battlebg"),I=new S0;this.engine.world.add(I),this.status="battle",gsap.to("#battle-overlay",{opacity:1,repeat:3,duration:.4,onComplete(){gsap.to("#battle-overlay",{opacity:0}),F.open=!0,window.transport.battleEnemy=I,window.transport.startBattle()}});break}}}}draw(t){typeof this[this.status]=="function"&&this[this.status](t)}}class P0 extends d{constructor(){super(100,450,16,16);this.status="static",this.image=window.gameLoader.assets.player,this.frame=0,this.elapse=0,this.engine=window.gameEngine,this.health=100}static(t){if(this.engine.world.get("battlebg").open){const{position:s,size:i,image:o,frame:a,opacity:r}=this;t.save(),t.globalAlpha=r,t.drawImage(o,a*16,16,i.width,i.height,s.x,s.y,i.width*4,i.height*4),t.restore(),this.elapse++,this.elapse%10===0&&(a<1?this.frame++:this.frame=0)}}draw(t){typeof this[this.status]=="function"&&this[this.status](t)}}class S0 extends d{constructor(){super(450,300,16,16);this.status="static",this.image=window.gameLoader.assets.spirit,this.frame=0,this.frameMax=4,this.elapse=0,this.engine=window.gameEngine,this.isEnemy=!0,this.health=100}static(t){if(this.engine.world.get("battlebg").open){const{position:s,size:i,image:o,frame:a,frameMax:r,opacity:h}=this;t.save(),t.globalAlpha=h,t.drawImage(o,0,a*16,i.width,i.height,s.x,s.y,i.width*4,i.height*4),t.restore(),this.elapse++,this.elapse%10===0&&(a<r-1?this.frame++:this.frame=0)}}draw(t){typeof this[this.status]=="function"&&this[this.status](t)}}const y=window.gameLoader=new X,v="./cdn/assets";y.add("map",`${v}/SproudLandMap.png`);y.add("foreground",`${v}/Foreground.png`);y.add("battlebg",`${v}/battle-background.png`);y.add("player",`${v}/Character.png`);y.add("spirit",`${v}/Spirit.png`);async function D0(){const n=window.gameEngine=new Q,t=window.gameRender=new t0({width:640,height:640,canvas:document.getElementById("my-game"),background:"transparent"});await y.load();const e=new $0,s=new A0,i=new I0,o=new R0,a=new P0,r=B0(),h=C0();o.init(),window.translateList=[e,s,...r.bodies,...h.bodies],window.transport.battlePlayer=a,n.world.add([e,o,r,h,s,i,a]),t.run(n)}const N0={class:"game-wrapper"},T0=l("canvas",{id:"my-game"},null,-1),F0=l("div",{id:"battle-overlay"},null,-1),K0=q('<div class="battle-lifebar battle-lifebar__enemy"><h4>Spirit</h4><div class="lifebar-wrapper"><div id="enemy-life" class="lifebar"></div></div></div><div class="battle-lifebar battle-lifebar__us"><h4>Maju</h4><div class="lifebar-wrapper"><div id="us-life" class="lifebar"></div></div></div>',2),V0={key:0,id:"battle-panel"},O0={class:"left"},j0=l("div",{class:"right"},"Attack Type",-1),U0=C({setup(n){const t=S(!1),e=S(!0),s={startBattle:a,stopBattle:r},i={tackle:{type:"tackle",damage:50}};let o=null;function a(){console.log("battle start"),t.value=!0}function r(){console.log("battle end"),clearTimeout(o),t.value=!1,e.value=!0,s.battlePlayer.health=100}function h(u){e.value=!1,s.battlePlayer.attack({attack:i[u],target:s.battleEnemy}),o=setTimeout(()=>{x("tackle")},2e3)}function x(u){s.battleEnemy.attack({attack:i[u],target:s.battlePlayer}),setTimeout(()=>{e.value=!0},2e3)}return j(()=>{window.transport=s,D0()}),(u,f)=>(b(),k("div",N0,[T0,F0,t.value?(b(),k(U,{key:0},[K0,e.value?(b(),k("div",V0,[l("div",O0,[l("div",{onClick:f[0]||(f[0]=z=>h("tackle"))},"Tackle"),l("div",{onClick:f[1]||(f[1]=z=>h("tackle"))},"Tackle")]),j0])):D("",!0)],64)):D("",!0)]))}});const q0={class:"view-home"},G0={class:"content"},H0=l("h2",null,"Vue Tiny Pokemon Game",-1),Z0=l("div",{class:"intro"},[p(" Press "),l("kbd",null,"w"),p(", "),l("kbd",null,"a"),p(", "),l("kbd",null,"s"),p(", "),l("kbd",null,"d"),p(" to move "),l("br"),p(" Moving on "),l("mark",null,"dirt ground(\u6CE5\u5730)"),p(" will jump out monster spirit ")],-1),J0=C({setup(n){return(t,e)=>(b(),k("div",q0,[l("div",G0,[H0,G(U0),Z0])]))}});const Q0=C({setup(n){return(t,e)=>(b(),H(J0))}});Z(Q0).mount("#app");export{X0 as __vite_legacy_guard};
